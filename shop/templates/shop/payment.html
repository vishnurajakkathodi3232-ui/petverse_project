{% extends "core/base.html" %}
{% load static %}

{% block content %}
<style>
    .payment-card {
        border-radius: 14px;
        background: #faf7f2; /* pale brown */
        border: 1px solid #e6dfd4;
        padding: 30px;
    }

    .amount-text {
        font-size: 26px;
        font-weight: 700;
        color: #2e8b57;
    }

    .secure-note {
        font-size: 13px;
        color: #777;
    }
</style>

<div class="container" style="margin-top:140px; max-width:600px;">

    <div class="payment-card text-center">

        <h3 class="mb-2">Secure Payment üí≥</h3>
        <p class="text-muted">
            Complete your purchase securely using Razorpay
        </p>

        <hr>

        <p>
            <strong>Order ID:</strong> #{{ order.id }}
        </p>

        <p class="mb-2">
            <strong>Amount Payable</strong>
        </p>

        <div class="amount-text">
            ‚Çπ {{ amount }}
        </div>

        <hr>

        <!-- PAY BUTTON -->
        <button id="rzp-button"
                class="btn btn-success btn-lg">
            Pay with Razorpay
        </button>

        <p class="secure-note mt-3">
            100% secure payment ‚Ä¢ Cards ‚Ä¢ UPI ‚Ä¢ Netbanking
        </p>

        <div class="mt-3">
            <a href="{% url 'shop:cart_detail' %}" class="btn btn-link">
                ‚Üê Back to Cart
            </a>
        </div>

    </div>

</div>

<!-- Razorpay Checkout -->
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
    var options = {
        "key": "{{ razorpay_key }}",   // from settings.py
        "amount": "{{ amount|floatformat:2 }}", // UI amount (Razorpay uses order_id amount)
        "currency": "{{ currency }}",
        "name": "PetVerse",
        "description": "Pet Products Order",
        "order_id": "{{ razorpay_order_id }}",

        "handler": function (response) {
            /*
                NOTE:
                Signature verification + payment_id saving
                will be added later in backend.
            */
            window.location.href = "{% url 'shop:payment_success' order.id %}";
        },

        "theme": {
            "color": "#2e8b57"
        }
    };

    var rzp1 = new Razorpay(options);

    document.getElementById("rzp-button").onclick = function(e) {
        rzp1.open();
        e.preventDefault();
    };
</script>
{% endblock %}
